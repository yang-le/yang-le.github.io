# 拉格朗日力学

本书的主题是运动和用于描述运动的数学工具。

## 配置空间

指定一个系统的所有组成粒子的位置就指定了系统的配置。

系统的各部分之间存在约束，例如决定物体形状的那些，意味着组成系统的粒子并非可以占据任意的位置。系统可以占据的所有配置的集合称为系统的配置空间。

配置空间的维度是完全指定该配置所需的最少参数的数量，也被称为该系统的自由度。

系统随着时间演化，其组成粒子在满足特定约束的前提下运动。每个粒子的运动都可由配置的变化来描述。因此，系统的运动可由沿配置空间中的路径的演化来描述。配置路径可由一个函数指定，即配置路径函数，它给出系统在任意时间的配置。

### 练习1.1 自由度

对于如下描述的每个力学系统，给出其配置空间的自由度。

a. 三个杂耍棒。

> 18

b. 球形摆。固定于无质量刚性杆上的质点（摆锤），除受到刚性杆的约束外，可向任意方向运动。刚性杆连接到一个固定的支撑点。整个系统位于均匀的重力场中。

> 2

c. 球形双摆。由固定于一刚性无质量杆上的质点组成，杆连接到另一质点，该质点又固定于另一（刚性）无质量杆，最终连接到一固定支撑点。两质点均位于均匀重力场中。

> 4

d. 质点在弯曲的刚性线上无摩擦地滑动。

> 1

e. 刚性轴对称陀螺，其对称轴上有一点附于一支撑点上，受到均匀重力场的作用。

> 2 (偏离垂直轴的立体角)

f. 同上，但陀螺不是轴对称的。

> 3 (除考虑立体角外，需要考虑陀螺自身的旋转角度)

## 广义坐标

指定系统配置的参数称为广义坐标。广义坐标的个数不必与配置空间的维度相等，但不能小于该维度。我们可以选择多于必需参数的坐标，但这些参数将受限于系统可能的配置，即配置空间的元素。通常选择与系统配置空间维度相等个数的坐标是较方便的。

一般来说，（系统的）所有配置构成一个维度为$n$的空间$M$。该$n$维配置空间可通过选择一个坐标函数$\chi$来参数化，它将配置空间中的元素映射到实数的$n$元组。如果我们考虑的是高于一维的情形，则函数$\chi$将是$n$个独立坐标函数$\chi^i, i = 0, \dots, n -1$的元组，其中每个$\chi^i$都是一个定义于配置空间某个区域上的实值函数。对于给定的配置空间$M$中的配置$m$，坐标函数的值$\chi^i(m)$即是该配置的广义坐标。这些广义坐标允许我们使用实数的$n$元组来指定$n$维配置空间中的点。对于任意给定的配置空间，可以有许多不同的方式来选择广义坐标。即使是对于不受约束的单个质点，我们可以选择直角坐标，极坐标，或者其它的什么坐标。

系统的运动可由一个配置路径$\gamma$所描述，它将时间映射到配置空间中的点。对应于配置路径的是坐标路径$q = \chi\circ\gamma$，它将时间映射到广义坐标构成的元组。如果考虑高于一个自由度的系统，则坐标路径是一个结构化的对象：$q$是坐标分量函数$q^i = \chi^i\circ\gamma$的构成的元组。在每一个时刻$t$，值$q(t) = (q^0(t), \dots, q^{n - 1}(t))$是某个配置的广义坐标。

坐标路径$q$的导数$Dq$是一个函数，它给出任意时刻配置（广义）坐标的变化率：$Dq(t) = (Dq^0(t), \dots, Dq^{n - 1}(t))$。广义坐标的变化率称为广义速度。

## 平稳作用量原理

我们假定对于每一个物理系统都有一个路径区分函数，其在可实现路径上是平稳的。

### 可实现路径

从经验出发我们可以建立关于可实现的配置路径的特定期望。如果一个路径是可实现的，则其中的任意一段都应是可实现的。路径的可实现性以同样的方式取决于其上的所有点，没有哪个部分是特殊的。路径的可实现性只取决于路径内的点，这说明路径的可实现性是一个局部性质。

所以路径区分函数在每一时刻以一致的方式收集了系统沿着路径的某种局部性质。每一时刻的贡献必须以一种能够维持各段独立性的方式组合起来。一种符合这些要求的组合方式是相加，这使得路径区分函数成为沿着路径的对路径的某种局部性质的积分。

所以我们将这样构造路径区分函数，使其成为沿着路径的某种局部性质的积分，并假定对于任意的可实现路径其值是平稳的。这样一种路径区分函数传统上称为系统的作用量。

令$q = \chi\circ\gamma$是配置空间中的坐标路径；$q(t)$是配置在时刻$t$的坐标。则一段在时间区间$t_1$到$t_2$内的路径的作用量为
$$S[q](t_1, t_2) = \int_{t_1}^{t_2}F[q]$$

其中$F[q]$是关于时间的函数，度量了路径的某种局部性质。它可以依赖于函数$q$在该时刻的值，以及$q$的任意阶导数在该时刻的值。

在特定时刻，配置路径可被局部地描述为坐标，该时刻的坐标变化率以及所有的高阶导数。给定这些信息路径就可以在包含这一时刻的一段区间内重建出来。路径的局部性质最多无非也就是关于路径的这些局部描述。

函数$F$度量了坐标路径$q$的某种局部性质。我们可以将其分解为两部分：一部分用来度量这种局部描述的性质，另一部分用来从路径函数中抽取这些局部描述。度量这种局部性质的函数依赖于特定的物理系统；而从一个路径构建其局部描述的方法应当对任意系统都是相同的。我们可以将$F[q]$写为这两个函数的复合：
$$F[q] = L\circ\Gamma[q]$$

函数$\Gamma$接受一个坐标路径并返回一个关于时间的函数，其值是包含时刻，该时刻的坐标以及该时刻的坐标的高阶导数值的有序元组。对于路径$q$和时刻$t$：
$$\Gamma[q](t) = (t, q(t), Dq(t), \dots)$$

我们称这个元组，其包含了我们需要的任意阶导数，为局部元组。函数$\Gamma[q]$仅依赖于坐标路径$q$及其各阶导数；函数$\Gamma[q]$不依赖于$\chi$或者$q$是由$\chi$和$\gamma$复合而成的这样一个事实。

函数$L$依赖于我们研究的物理系统的特定细节，但不依赖于任何特定的配置路径。函数$L$计算路径的一个实值的局部性质。我们将会发现$L$仅需要局部元组的有限个分量来计算这个性质：路径可由完整的局部描述局部地重建；$L$依赖于局部元组的有限分量保证了其度量的是一个局部性质。

这种分解的一个优点是路径的局部描述是由一个统一的过程从配置路径算出的，其独立于被考虑的系统。所有特定于系统的信息都由函数$L$所捕获。

函数$L$被称为系统的拉格朗日量，由此得到的作用量
$$S[q](t_1, t_2) = \int_{t_1}^{t_2}L\circ\Gamma[q]$$

被称为拉格朗日作用量。对于仅依赖于时间，位置和速度的拉格朗日量这个作用量也可被写为

$$S[q](t_1, t_2) = \int_{t_1}^{t_2}L(t, q(t), Dq(t))dt$$

对于一大类系统拉其格朗日量都可以被找到。我们将会看到对于许多系统来说拉格朗日量可以取动能和势能的差值。这些拉格朗日量仅依赖于时间，配置和配置的变化率。我们将专注于这类系统，但偶尔也会考虑更一般的系统。

一个可实现路径具有平稳的作用量，这是相对于其附近的不可实现的路径集合来说的。但是可实现路径附近的某些路径可能也是可实现的：对于杂耍棒的任意运动，总有另一个运动与其稍有不同。所以当强调作用量是否是相对于其附近的路径平稳这一问题时，我们必须在某种程度上限制我们所考虑的路径集合中仅有一个可实现路径。实际上，对于仅依赖配置和配置变化率的拉格朗日量，只要限制这个路径集合中的所有路径在路径端点处有相同的配置就足以满足这一条件了。

平稳作用量原理确保对每一个动力系统，我们都可以找到一个拉格朗日量，使得连接$t_1$和$t_2$时刻的两个配置的可实现路径可以从其他所有路径中区分出来，因为该路径的作用量$S[q](t_1, t_2)$相对于其他的路径是平稳的。对于仅依赖于配置和配置变化率的拉格朗日量，这些路径限于在$t_1$和$t_2$处有相同配置的那些。

## 计算作用量

为了展示上述想法，也为了将这些公式编制为计算机程序，我们考虑最简单的力学系统——一个在三维空间中移动的自由粒子。欧拉和拉格朗日发现对于自由粒子来说，其动能沿粒子实际路径对时间的积分比任何其他有着相同端点的路径都要小：自由粒子依照平稳作用量原理移动，只要我们取其拉格朗日量为动能。质量为$m$速度为$\vec v$的粒子其动能为$\frac{1}{2}mv^2$，其中$v$是$\vec v$的模长。这里我们可以取广义坐标为通常的直角坐标。

根据欧拉和拉格朗日的说法，自由粒子的拉格朗日量为
$$L(t,x,v) = \frac{1}{2}m(v\cdot v)$$

这里形式参数$x$表示给定的直角坐标系下的坐标分量的元组，形式参数$v$表示速度分量的元组。

我们可将这一公式表示为例程:
```scm
(define ((L-free-particle mass) local)
    (let ((v (velocity local)))
        (* 1/2 mass (dot-product v v))))
```
这个定义说明`L-free-particle`是一个以`mass`为参数的例程，并返回一个以局部元组`local`为参数的例程，它使用`velocity`提取广义速度，然后使用这个速度计算拉格朗日量的值。

假定我们令$q$表示坐标路径函数，它将时间映射到位置分量
$$q(t) = (x(t), y(t), z(t))$$

我们可以这样定义它
```scm
(define q
    (up (literal-function 'x)
        (literal-function 'y)
        (literal-function 'z)))
```

其中`literal-function`构造一个例程，表示一个单参数函数，除了给定的符号名之外，该函数的性质未知。符号`q`现在表示一个单实数参数（时刻）例程，它生成一个三分量的元组表示对应时刻的坐标。例如，我们可以像下面这样对该例程在时刻`t`求值
```scm
(q 't)
```
> (up (x t) (y t) (z t))

坐标路径的导数$Dq$是映射时间到速度分量的函数
$$Dq(t) = (Dx(t), Dy(t), Dz(t))$$

我们可以作出并使用一个函数的导数。例如，我们可以写
```scm
((D q) 't)
```
> (up ((D x) t) ((D y) t) ((D z) t))

函数$\Gamma$接受一个坐标路径并返回一个关于时刻的函数，它给出局部元组$(t, q(t), Dq(t), \dots)$。我们以例程`Gamma`实现这个$\Gamma$。它的行为是这样的
```scm
((Gamma q) 't)
```
<blockquote><pre>
(up t 
    (up (x t) (y t) (z t))
    (up ((D x) t) ((D y) t) ((D z) t)))
</pre></blockquote>

所以复合$L \circ \Gamma$是一个关于时刻的函数，返回该点在路径上的拉格朗日量的值
```scm
((compose (L-free-particle 'm) (Gamma q)) 't)
```
<blockquote><pre>
(+ (* 1/2 m (expt ((D x) t) 2))
   (* 1/2 m (expt ((D y) t) 2))
   (* 1/2 m (expt ((D z) t) 2)))
</pre></blockquote>

例程`show-expression`化简表达式并使用$\TeX$以传统的中缀形式显示结果。我们使用这个方法来制作本书中方框中的表达式。这个例程也生成前缀形式，不过我们通常不展示它。
```scm
(show-expression
    ((compose (L-free-particle 'm) (Gamma q)) 't))
```
> $$\frac{1}{2}m(Dx(t))^2 + \frac{1}{2}m(Dy(t))^2 + \frac{1}{2}m(Dz(t))^2$$

现在我们可以计算从时刻$t_1$到时刻$t_2$的拉格朗日作用量如下：
```scm
(define (Lagrangian-action L q t1 t2)
    (definite-integral (compose L (Gamma q)) t1 t2))
```
`Lagrangian-action`以计算拉格朗日量的例程`L`，计算坐标路径的例程`q`以及起始和终止时刻`t1`和`t2`为参数。这里使用的`definite-integral`以一个函数和两个积分限`t1`和`t2`为参数，计算该函数在区间`t1`到`t2`上的定积分。注意`Lagrangian-action`的定义不依赖于任何特定的坐标集甚至是配置空间的维度。从拉格朗日量的坐标表示和坐标路径计算作用量的方法不依赖于坐标系统。

我们现在可以为自由粒子沿给定路径计算作用量了。例如，考虑一个以均匀速度沿直线$t \mapsto (4t + 7, 3t + 5, 2t + 1)$运动的粒子。我们将其路径表示为例程
```scm
(define (test-path t)
    (up (+ (* 4 t) 7)
        (+ (* 3 t) 5)
        (+ (* 2 t) 1)))
```

对于一个质量为$3$的粒子，我们取其位于$t = 0$和$t = 10$之间的作用量
```scm
(Lagrangian-action (L-free-particle 3.0) test-path 0.0 10.0)
```
> 435

### 练习1.4 拉格朗日作用量

对于自由粒子一个合适的拉格朗日量是
$$L(t, x, v) = \frac{1}{2}mv^2$$

假设$x$是匀速直线路径，满足$x_a = x(t_a)$和$x_b = x(t_b)$。证明其解的路径上的作用量是
$$\frac{m}{2}\frac{(x_b - x_a)^2}{t_b - t_a}$$

## 最小作用量路径

我们已经知道自由粒子的实际路径是匀速直线运动。根据欧拉和拉格朗日的说法，沿直线路径的作用量要比附近的其他路径小。
令$q$是一个直线路径，其作用量为$S[q](t_1, t_2)$。令$q + \epsilon\eta$是其附近的一个路径。
